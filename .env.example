# Database
CODEX_LB_DATABASE_URL=sqlite+aiosqlite:///~/.codex-lb/store.db
CODEX_LB_ACCOUNTS_DATABASE_URL=sqlite+aiosqlite:///~/.codex-lb/accounts.db
# Example (iCloud Drive):
# CODEX_LB_ACCOUNTS_DATABASE_URL=sqlite+aiosqlite:///~/Library/Mobile Documents/com~apple~CloudDocs/codex-lb/accounts.db

# Upstream ChatGPT base URL (no /codex suffix)
CODEX_LB_UPSTREAM_BASE_URL=https://chatgpt.com/backend-api

# Timeouts (seconds)
CODEX_LB_UPSTREAM_CONNECT_TIMEOUT_SECONDS=30
CODEX_LB_STREAM_IDLE_TIMEOUT_SECONDS=300

# OAuth / token refresh
CODEX_LB_AUTH_BASE_URL=https://auth.openai.com
CODEX_LB_OAUTH_CLIENT_ID=app_EMoamEEZ73f0CkXaXp7hrann
CODEX_LB_OAUTH_SCOPE="openid profile email"
CODEX_LB_OAUTH_TIMEOUT_SECONDS=30
CODEX_LB_OAUTH_REDIRECT_URI=http://localhost:1455/auth/callback
CODEX_LB_OAUTH_CALLBACK_HOST=127.0.0.1
# Do not change the port. OpenAI dislikes changes.
CODEX_LB_OAUTH_CALLBACK_PORT=1455
CODEX_LB_TOKEN_REFRESH_TIMEOUT_SECONDS=30
CODEX_LB_TOKEN_REFRESH_INTERVAL_DAYS=8

# Encryption key file (optional override; keep this with your accounts DB if you want accounts to roam)
# CODEX_LB_ENCRYPTION_KEY_FILE=/var/lib/codex-lb/encryption.key

# Upstream usage fetch
CODEX_LB_USAGE_FETCH_TIMEOUT_SECONDS=10
CODEX_LB_USAGE_FETCH_MAX_RETRIES=2
CODEX_LB_USAGE_REFRESH_ENABLED=true
CODEX_LB_USAGE_REFRESH_INTERVAL_SECONDS=60

# Proxy account selection:
# Waste-pressure is always enabled. Legacy selection strategy configuration was removed.

# Proxy routing snapshot TTL (seconds).
# Higher values reduce DB reads under concurrency but can delay reacting to DB-driven changes
# (usage refresh results, dashboard toggles) by up to ~TTL seconds.
# Default (if unset): 10.0
# Typical tuned values:
# - 5â€“10: better throughput/latency under concurrency (common single-process tuning).
# - 1: more "fresh" routing based on DB changes.
# CODEX_LB_PROXY_SNAPSHOT_TTL_SECONDS=10

# Sticky sessions backend:
# - memory (default): fastest; per-process; resets on restart.
# - db: shared across processes; survives restart; adds DB write load on the proxy hot path.
# CODEX_LB_STICKY_SESSIONS_BACKEND=memory
